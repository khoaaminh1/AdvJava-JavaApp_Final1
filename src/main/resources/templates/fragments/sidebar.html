<div xmlns:th="http://www.thymeleaf.org" th:fragment="sidebar(active)">
  <aside class="sidebar">
    <div class="brand">
      <img th:src="@{/R.jpg}" alt="Logo" class="brand-logo"/>
      <div class="brand-text">
        <div class="brand-title">Personal</div>
        <div class="brand-subtitle">Finance</div>
      </div>
    </div>
    <nav class="menu">
      <a th:href="@{/dashboard}" th:classappend="${active}=='dashboard' ? 'active' : ''">
        <i class="ri-dashboard-2-line"></i>
        <span>Dashboard</span>
      </a>
      <a th:href="@{/transactions}" th:classappend="${active}=='transactions' ? 'active' : ''">
        <i class="ri-exchange-dollar-line"></i>
        <span>Transactions</span>
      </a>
      <a th:href="@{/budgets}" th:classappend="${active}=='budgets' ? 'active' : ''">
        <i class="ri-wallet-3-line"></i>
        <span>Budgets</span>
      </a>
      <a th:href="@{/categories}" th:classappend="${active}=='categories' ? 'active' : ''">
        <i class="ri-price-tag-3-line"></i>
        <span>Categories</span>
      </a>
      <a th:href="@{/accounts}" th:classappend="${active}=='accounts' ? 'active' : ''">
        <i class="ri-bank-card-line"></i>
        <span>Accounts</span>
      </a>
    </nav>
    <div class="sidebar-footer">
      <a th:href="@{/settings}" th:classappend="${active}=='settings' ? 'active' : ''">
        <i class="ri-settings-3-line"></i> <span>Settings</span>
      </a>
      <div class="theme-toggle-container" style="padding: 0.5rem 1.5rem; display: flex; align-items: center; gap: 1rem; color: rgba(255,255,255,0.7);">
        <i class="ri-moon-line"></i>
        <span style="flex: 1; font-weight: 500;">Dark Mode</span>
        <label class="switch-sm">
          <input type="checkbox" id="sidebarThemeToggle" checked>
          <span class="slider-sm round"></span>
        </label>
      </div>
    </div>
  </aside>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        const toggle = document.getElementById('sidebarThemeToggle');
        const html = document.documentElement;
        
        // Check saved preference
        const savedTheme = localStorage.getItem('theme');
        
        // Default is dark (no data-theme attribute needed for default CSS)
        // If savedTheme is 'light', we set data-theme="light" and uncheck the toggle
        if (savedTheme === 'light') {
            toggle.checked = false;
            html.setAttribute('data-theme', 'light');
        } else {
            // Default or explicitly dark
            toggle.checked = true;
            html.removeAttribute('data-theme');
        }
        
        // Handle toggle change
        toggle.addEventListener('change', function(e) {
            if (e.target.checked) {
                // Switch to Dark (Default)
                html.removeAttribute('data-theme');
                localStorage.setItem('theme', 'dark');
            } else {
                // Switch to Light
                html.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
            }
        });
    });
  </script>
</div>
  